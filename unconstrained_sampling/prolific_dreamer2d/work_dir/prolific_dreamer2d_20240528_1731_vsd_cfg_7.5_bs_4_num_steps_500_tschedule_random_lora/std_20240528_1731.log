2024-05-28 17:31:52 INFO --> [INFO] Cmdline: prolific_dreamer2d.py --num_steps 500 --log_steps 100 --seed 6 --lr 0.03 --phi_lr 0.0001 --use_t_phi true --model_path stabilityai/stable-diffusion-2-1-base --loss_weight_type 1m_alphas_cumprod --t_schedule random --generation_mode vsd --phi_model lora --lora_scale 1. --lora_vprediction false --prompt a blue bicycle parked by a metal gate. --height 512 --width 512 --batch_size 4 --guidance_scale 7.5 --particle_num_vsd 4 --particle_num_phi 4 --log_progress false --save_x0 false --save_phi_model true --coeff 0 --gpu 6 --dino --index_folder 2
2024-05-28 17:31:52 INFO --> Using device: cuda; version: 12.1
2024-05-28 17:31:52 INFO --> NVIDIA A100-SXM4-80GB
2024-05-28 17:31:52 INFO --> ################# Arguments: ####################
2024-05-28 17:31:52 INFO --> 	seed: 6
2024-05-28 17:31:52 INFO --> 	log_steps: 100
2024-05-28 17:31:52 INFO --> 	log_progress: False
2024-05-28 17:31:52 INFO --> 	log_gif: False
2024-05-28 17:31:52 INFO --> 	model_path: stabilityai/stable-diffusion-2-1-base
2024-05-28 17:31:52 INFO --> 	run_date: 20240528
2024-05-28 17:31:52 INFO --> 	run_time: 1731
2024-05-28 17:31:52 INFO --> 	work_dir: work_dir/prolific_dreamer2d_20240528_1731_vsd_cfg_7.5_bs_4_num_steps_500_tschedule_random_lora
2024-05-28 17:31:52 INFO --> 	half_inference: False
2024-05-28 17:31:52 INFO --> 	save_x0: False
2024-05-28 17:31:52 INFO --> 	save_phi_model: True
2024-05-28 17:31:52 INFO --> 	load_phi_model_path: 
2024-05-28 17:31:52 INFO --> 	use_mlp_particle: False
2024-05-28 17:31:52 INFO --> 	init_img_path: 
2024-05-28 17:31:52 INFO --> 	num_steps: 500
2024-05-28 17:31:52 INFO --> 	t_end: 980
2024-05-28 17:31:52 INFO --> 	t_start: 20
2024-05-28 17:31:52 INFO --> 	multisteps: 1
2024-05-28 17:31:52 INFO --> 	t_schedule: random
2024-05-28 17:31:52 INFO --> 	prompt: a blue bicycle parked by a metal gate.
2024-05-28 17:31:52 INFO --> 	n_prompt: 
2024-05-28 17:31:52 INFO --> 	height: 512
2024-05-28 17:31:52 INFO --> 	width: 512
2024-05-28 17:31:52 INFO --> 	rgb_as_latents: True
2024-05-28 17:31:52 INFO --> 	generation_mode: vsd
2024-05-28 17:31:52 INFO --> 	batch_size: 4
2024-05-28 17:31:52 INFO --> 	particle_num_vsd: 4
2024-05-28 17:31:52 INFO --> 	particle_num_phi: 4
2024-05-28 17:31:52 INFO --> 	guidance_scale: 7.5
2024-05-28 17:31:52 INFO --> 	cfg_phi: 1.0
2024-05-28 17:31:52 INFO --> 	optimizer: adam
2024-05-28 17:31:52 INFO --> 	lr: 0.03
2024-05-28 17:31:52 INFO --> 	betas: (0.9, 0.999)
2024-05-28 17:31:52 INFO --> 	weight_decay: 0.0
2024-05-28 17:31:52 INFO --> 	phi_lr: 0.0001
2024-05-28 17:31:52 INFO --> 	phi_model: lora
2024-05-28 17:31:52 INFO --> 	use_t_phi: True
2024-05-28 17:31:52 INFO --> 	phi_update_step: 1
2024-05-28 17:31:52 INFO --> 	lora_vprediction: False
2024-05-28 17:31:52 INFO --> 	lora_scale: 1.0
2024-05-28 17:31:52 INFO --> 	use_scheduler: False
2024-05-28 17:31:52 INFO --> 	lr_scheduler_start_factor: 0.3333333333333333
2024-05-28 17:31:52 INFO --> 	lr_scheduler_iters: 300
2024-05-28 17:31:52 INFO --> 	loss_weight_type: 1m_alphas_cumprod
2024-05-28 17:31:52 INFO --> 	nerf_init: False
2024-05-28 17:31:52 INFO --> 	grad_scale: 1.0
2024-05-28 17:31:52 INFO --> 	dino_flag: True
2024-05-28 17:31:52 INFO --> 	lpips_flag: False
2024-05-28 17:31:52 INFO --> 	coeff: 0.0
2024-05-28 17:31:52 INFO --> 	gpu: 6
2024-05-28 17:31:52 INFO --> 	index_folder: 2
2024-05-28 17:31:52 INFO --> 	save_path: /home/nzilberstein/repository/unconstrained_sampling/prolific_dreamer2d/generated_images
2024-05-28 17:31:52 INFO --> 	run_id: 20240528_1731
2024-05-28 17:31:52 INFO --> 	device: cuda
2024-05-28 17:31:53 INFO --> Dino loaded, and dino flag is true
2024-05-28 17:31:53 INFO --> load models from path: stabilityai/stable-diffusion-2-1-base
2024-05-28 17:31:53 DEBUG --> Starting new HTTPS connection (1): huggingface.co:443
2024-05-28 17:31:54 DEBUG --> https://huggingface.co:443 "HEAD /stabilityai/stable-diffusion-2-1-base/resolve/main/vae/config.json HTTP/1.1" 200 0
2024-05-28 17:31:54 DEBUG --> https://huggingface.co:443 "HEAD /stabilityai/stable-diffusion-2-1-base/resolve/main/tokenizer/tokenizer_config.json HTTP/1.1" 200 0
2024-05-28 17:31:54 DEBUG --> https://huggingface.co:443 "HEAD /stabilityai/stable-diffusion-2-1-base/resolve/main/text_encoder/config.json HTTP/1.1" 200 0
2024-05-28 17:31:54 DEBUG --> https://huggingface.co:443 "HEAD /stabilityai/stable-diffusion-2-1-base/resolve/main/text_encoder/config.json HTTP/1.1" 200 0
2024-05-28 17:31:54 DEBUG --> https://huggingface.co:443 "HEAD /stabilityai/stable-diffusion-2-1-base/resolve/main/unet/config.json HTTP/1.1" 200 0
2024-05-28 17:31:55 DEBUG --> https://huggingface.co:443 "HEAD /stabilityai/stable-diffusion-2-1-base/resolve/main/scheduler/scheduler_config.json HTTP/1.1" 200 0
2024-05-28 17:31:56 INFO --> ################# Metrics: ####################
2024-05-28 17:31:56 INFO --> DINO mode
2024-05-28 17:31:58 INFO --> step: 0; average loss: 0.00031477821175940335
2024-05-28 17:31:58 DEBUG --> Loaded backend agg version v2.2.
